import{_ as n,c as s,d as a,o as i}from"./app-CoWwpxfE.js";const t={};function l(r,e){return i(),s("div",null,e[0]||(e[0]=[a(`<h1 id="using-inspireface-in-python-on-rockchip-linux" tabindex="-1"><a class="header-anchor" href="#using-inspireface-in-python-on-rockchip-linux"><span>Using InspireFace in Python on Rockchip Linux</span></a></h1><p>If you want to run InspireFace on a Rockchip device with a Linux system and get hardware acceleration support such as <strong>Rockchip NPU</strong> and <strong>Rockchip RGA</strong>, you need to manually create a Python version installation package.</p><div class="hint-container warning"><p class="hint-container-title">Warning</p><p>If you do not need the support of device acceleration such as NPU and RGA, you can directly use pip to install the regular CPU version. This will be very easy, but you will not be able to leverage the performance advantages of the device, and the computation speed will be slow.</p></div><p>Before creating the installation package, ensure that the following configurations are complete:</p><ul><li>A device or virtual machine with the target architecture <ul><li>Docker container (Aarch64) or a physical Rockchip device (such as RK3566, RK3568, or RK3588)</li></ul></li><li>Python is installed on the device or virtual machine</li><li><strong>pip</strong> is installed on the device or virtual machine <ul><li>Requires toolkits such as <strong>setuptools</strong> and <strong>wheel</strong></li></ul></li></ul><h2 id="get-resources" tabindex="-1"><a class="header-anchor" href="#get-resources"><span>Get Resources</span></a></h2><p>For convenience, you can download the release installation file corresponding to your device from InspireFace&#39;s <a href="https://github.com/HyperInspire/InspireFace/releases" target="_blank" rel="noopener noreferrer">Releases Page</a>. Taking the <strong>RK356X/RK3588</strong> device as an example, select the latest installation package <strong>inspireface-linux-aarch64-rk356x-rk3588-x.y.z.zip</strong>.</p><div class="hint-container tip"><p class="hint-container-title">Tips</p><p>The sdk under the release page is continuously updated. It is recommended that you choose the latest version.</p></div><p>By decompressing it, you can see the files in the lib folder:</p><ul><li><strong>libInspireFace.so</strong></li><li><strong>librknnrt.so</strong></li></ul><p>When you have successfully obtained these two files, you can start creating the Python version installation package. You can also obtain these two files by compiling the source code.</p><h2 id="create-python-installation-package" tabindex="-1"><a class="header-anchor" href="#create-python-installation-package"><span>Create Python Installation Package</span></a></h2><p>Before creating the Python installation package, we need to understand the running mechanism of the Python version of InspireFace. In fact, we are just using Python&#39;s <strong>ctypes</strong> library to call the functions in the <strong>libInspireFace.so</strong> dynamic library to implement a layer of native call wrapper code to rely on the underlying C/C++ version. Therefore, in essence, the content of the Python version and the C/C++ version is highly consistent.</p><p>The source code location for the Python version is: <a href="https://www.google.com/search?q=https://github.com/HyperInspire/InspireFace/tree/master/python" target="_blank" rel="noopener noreferrer">InspireFace Python</a></p><h3 id="step-1-pull-source-code" tabindex="-1"><a class="header-anchor" href="#step-1-pull-source-code"><span>Step 1: Pull Source Code</span></a></h3><p>First, pull the InspireFace source code on the <strong>host device</strong>. You can also operate directly on a virtual machine or RK device (if git is installed on the RK device):</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code><span class="line"><span class="token function">git</span> clone https://github.com/HyperInspire/InspireFace.git</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>Navigate to the <code>InspireFace/python</code> directory:</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code><span class="line"><span class="token builtin class-name">cd</span> InspireFace/python</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>The python folder directory contains the core source code folder and some usage examples:</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code><span class="line">InspireFace/python/</span>
<span class="line">├── README.md</span>
<span class="line">├── inspireface</span>
<span class="line">│   ├── __init__.py</span>
<span class="line">│   ├── modules</span>
<span class="line">│   │   ├── __init__.py</span>
<span class="line">│   │   ├── core/</span>
<span class="line">│   │   ├── inspireface.py</span>
<span class="line">│   │   └── utils</span>
<span class="line">│   └── param.py</span>
<span class="line">├── pull_models.py</span>
<span class="line">├── read_nv21.py</span>
<span class="line">├── sample_face_comparison.py</span>
<span class="line">├── sample_face_detection.py</span>
<span class="line">├── sample_face_recognition.py</span>
<span class="line">├── sample_face_track_from_video.py</span>
<span class="line">├── sample_feature_hub.py</span>
<span class="line">├── sample_system_resource_statistics.py</span>
<span class="line">├── sample_video.py</span>
<span class="line">├── setup.py</span>
<span class="line">├── test/</span>
<span class="line">├── test.db</span>
<span class="line">├── test.py</span>
<span class="line">├── test.sh</span>
<span class="line">└── version.txt.in</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="step-2-install-rknnrt-on-the-rk-device" tabindex="-1"><a class="header-anchor" href="#step-2-install-rknnrt-on-the-rk-device"><span>Step 2: Install rknnrt on the RK Device</span></a></h3><p>InspireFace depends on the rknn-runtime library. You can obtain the <code>librknnrt.so</code> file through the previous steps. You need to transfer this file to your <strong>RK device</strong> and install it in the system directory:</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code><span class="line"><span class="token function">sudo</span> <span class="token function">cp</span> librknnrt.so /usr/local/lib</span>
<span class="line"><span class="token function">sudo</span> ldconfig</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>Note: This step must be performed on the RK device!</strong></p><p>The example places the dynamic library in the <code>/usr/local/lib</code> directory, which is a common path in Linux systems. If your device has other configurable dynamic library directories, you can use them directly. This depends on the factory configuration of your RK device manufacturer or your custom configuration.</p><h3 id="step-3-create-python-installation-package" tabindex="-1"><a class="header-anchor" href="#step-3-create-python-installation-package"><span>Step 3: Create Python Installation Package</span></a></h3><p>This step can be performed on an Aarch64 architecture virtual machine or directly on an <strong>RK device</strong>. The example here uses an <strong>RK356X device</strong>.</p><p>First, we need to move the <code>inspireface/python</code> directory from the host device to the virtual machine or <strong>RK device</strong>. If you already have this project in the target system, you can skip this step.</p><ul><li><p>Enter the python directory:</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code><span class="line"><span class="token builtin class-name">cd</span> python/</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li><li><p>Create the corresponding architecture directory:</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code><span class="line"><span class="token function">mkdir</span> <span class="token parameter variable">-p</span> inspireface/modules/core/libs/linux/arm64/</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li><li><p>Copy the libInspireFace.so file to the architecture directory:</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code><span class="line"><span class="token function">cp</span> YOUR_PATH/inspireface-linux-aarch64-rk356x-rk3588/InspireFace/lib/libInspireFace.so inspireface/modules/core/libs/linux/arm64/</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>And ensure the copy is successful:</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code><span class="line">inspireface/modules/core/libs/linux/arm64/</span>
<span class="line">└── libInspireFace.so</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>Create the wheel installation package:</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code><span class="line"><span class="token comment"># Execute the python command directly</span></span>
<span class="line"><span class="token assign-left variable">INSPIRE_FACE_TARGET_AARCH_MAPPING</span><span class="token operator">=</span>linux_aarch64 python3 setup.py bdist_wheel</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>After execution, you will find the corresponding wheel file in the <code>dist</code> directory. The file name will correspond to the version number of your current environment:</p><ul><li>dist/inspireface-0.0.0-cp38-cp38-linux_aarch64.whl</li></ul></li><li><p>Install inspireface:</p><p>You can distribute this whl file to other RK devices for installation:</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code><span class="line">pip <span class="token function">install</span> dist/inspireface-0.0.0-cp38-cp38-linux_aarch64.whl</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li></ul><p>Installation is successful at this step.</p><h3 id="step-4-test-sdk" tabindex="-1"><a class="header-anchor" href="#step-4-test-sdk"><span>Step 4: Test SDK</span></a></h3><p>After successful installation, we need to test and verify the usability of the SDK. Enter the python shell or write a python program to call inspireface directly. If you are using an RK3566 or RK3568 device, you need to load the <strong>Gundam_RK356X</strong> model. If it is an RK3588, you need to load <strong>Gundam_RK3588</strong>.</p><p>This step is very important and needs to be called globally. It only needs to be called once:</p><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py"><pre><code><span class="line"><span class="token keyword">import</span> inspireface <span class="token keyword">as</span> isf</span>
<span class="line"></span>
<span class="line"><span class="token comment"># This step will automatically download the model on first use</span></span>
<span class="line">isf<span class="token punctuation">.</span><span class="token builtin">reload</span><span class="token punctuation">(</span><span class="token string">&quot;Gundam_RK356X&quot;</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>After successful loading, information will be printed:</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code><span class="line">Rockchip dma heap configured path: /dev/dma_heap/system-uncached-dma32</span>
<span class="line"><span class="token operator">==</span> Load Gundam_RK356X-t3, Version: <span class="token number">3.2</span>, Release: <span class="token number">2025</span>-02-20 <span class="token operator">==</span></span>
<span class="line">Successfully loaded similarity converter config:</span>
<span class="line"> 	 threshold: <span class="token number">0.320000</span></span>
<span class="line"> 	 middle_score: <span class="token number">0.600000</span></span>
<span class="line"> 	 steepness: <span class="token number">10.000000</span></span>
<span class="line"> 	 output_min: <span class="token number">0.020000</span></span>
<span class="line"> 	 output_max: <span class="token number">1.000000</span></span>
<span class="line">Successfully reloaded resources</span>
<span class="line">True</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Continue to create a Face Session to verify if the algorithm functions are available:</p><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py"><pre><code><span class="line"><span class="token comment"># Configure a face quality detection function</span></span>
<span class="line">opt <span class="token operator">=</span> isf<span class="token punctuation">.</span>HF_ENABLE_QUALITY</span>
<span class="line">session <span class="token operator">=</span> isf<span class="token punctuation">.</span>InspireFaceSession<span class="token punctuation">(</span>opt<span class="token punctuation">,</span> isf<span class="token punctuation">.</span>HF_DETECT_MODE_ALWAYS_DETECT<span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="more-usage-examples" tabindex="-1"><a class="header-anchor" href="#more-usage-examples"><span>More Usage Examples</span></a></h2><p>After completing the above steps, the task of installing the InspireFace-Rockchip version in the Python environment is complete. If you want to know more usage cases of the Python API, you can check: <a href="https://www.google.com/search?q=https://github.com/HyperInspire/InspireFace/tree/master/python" target="_blank" rel="noopener noreferrer">InspireFace Python</a></p>`,41)]))}const o=n(t,[["render",l]]),p=JSON.parse('{"path":"/guides/python-rockchip-device.html","title":"Using InspireFace in Python on Rockchip Linux","lang":"en-US","frontmatter":{},"headers":[{"level":2,"title":"Get Resources","slug":"get-resources","link":"#get-resources","children":[]},{"level":2,"title":"Create Python Installation Package","slug":"create-python-installation-package","link":"#create-python-installation-package","children":[{"level":3,"title":"Step 1: Pull Source Code","slug":"step-1-pull-source-code","link":"#step-1-pull-source-code","children":[]},{"level":3,"title":"Step 2: Install rknnrt on the RK Device","slug":"step-2-install-rknnrt-on-the-rk-device","link":"#step-2-install-rknnrt-on-the-rk-device","children":[]},{"level":3,"title":"Step 3: Create Python Installation Package","slug":"step-3-create-python-installation-package","link":"#step-3-create-python-installation-package","children":[]},{"level":3,"title":"Step 4: Test SDK","slug":"step-4-test-sdk","link":"#step-4-test-sdk","children":[]}]},{"level":2,"title":"More Usage Examples","slug":"more-usage-examples","link":"#more-usage-examples","children":[]}],"git":{"updatedTime":1747713251000,"contributors":[{"name":"tunm","username":"tunm","email":"tunmxy@163.com","commits":1,"url":"https://github.com/tunm"}],"changelog":[{"hash":"54fd0f9fc15f9c373ac126d0a25af3914d80f024","time":1747713251000,"email":"tunmxy@163.com","author":"tunm","message":"Update python api"}]},"filePathRelative":"guides/python-rockchip-device.md"}');export{o as comp,p as data};
