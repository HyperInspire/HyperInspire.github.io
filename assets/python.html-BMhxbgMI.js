import{_ as s,c as a,d as p,o as t}from"./app-Byu5Rsq9.js";const e={};function o(i,n){return t(),a("div",null,n[0]||(n[0]=[p(`<h1 id="using-inspireface-in-python" tabindex="-1"><a class="header-anchor" href="#using-inspireface-in-python"><span>Using InspireFace in Python</span></a></h1><p>The python version of inspireface is based on ctypes and the standard edition of InspireFaceSDK libraries, and usually requires <strong>python &gt;= 3.7</strong>.</p><div class="hint-container warning"><p class="hint-container-title">Warning</p><p>If you install inspireface from pypi, it is usually a regular version that <strong>only supports the cpu</strong> version. If you want to build python based on CUDA, Rockchip NPU, ANE inference backend, you will need to re-adapt the corresponding version of the library to the Python project. See the repository for <a href="https://github.com/HyperInspire/InspireFace/tree/master/python" target="_blank" rel="noopener noreferrer">more details</a>.</p></div><h2 id="installation-and-setup" tabindex="-1"><a class="header-anchor" href="#installation-and-setup"><span>Installation and Setup</span></a></h2><p>You can use pip to install the InspireFace Python package:</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code><span class="line">pip <span class="token function">install</span> <span class="token parameter variable">-U</span> inspireface</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h2 id="how-to-switch-models" tabindex="-1"><a class="header-anchor" href="#how-to-switch-models"><span>How to switch models</span></a></h2><p>You can start or restart global initialization with the reload function. You can use model_name to specify the model to use, such as Pikachu or Megatron, or you can use the resource_path parameter to specify a model path.</p><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py"><pre><code><span class="line"><span class="token keyword">import</span> inspireface <span class="token keyword">as</span> isf</span>
<span class="line"></span>
<span class="line"><span class="token comment"># Will download automatically</span></span>
<span class="line">isf<span class="token punctuation">.</span><span class="token builtin">reload</span><span class="token punctuation">(</span>model_name<span class="token operator">=</span><span class="token string">&#39;Pikachu&#39;</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># Direct use path</span></span>
<span class="line">isf<span class="token punctuation">.</span><span class="token builtin">reload</span><span class="token punctuation">(</span>model_name<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> resource_path<span class="token operator">=</span><span class="token string">&quot;/home/user/Pikachu&quot;</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="example-face-detect-and-pipeline" tabindex="-1"><a class="header-anchor" href="#example-face-detect-and-pipeline"><span>[Example]Face Detect and Pipeline</span></a></h2><p>Face detection and some use cases of face attribute analysis:</p><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py"><pre><code><span class="line"><span class="token keyword">import</span> os</span>
<span class="line"><span class="token keyword">import</span> cv2</span>
<span class="line"><span class="token keyword">import</span> inspireface <span class="token keyword">as</span> isf</span>
<span class="line"><span class="token keyword">import</span> click</span>
<span class="line"><span class="token keyword">import</span> numpy <span class="token keyword">as</span> np</span>
<span class="line"></span>
<span class="line">race_tags <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">&quot;Black&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Asian&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Latino/Hispanic&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Middle Eastern&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;White&quot;</span><span class="token punctuation">]</span></span>
<span class="line">gender_tags <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">&quot;Female&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Male&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">]</span></span>
<span class="line">age_bracket_tags <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">&quot;0-2 years old&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;3-9 years old&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;10-19 years old&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;20-29 years old&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;30-39 years old&quot;</span><span class="token punctuation">,</span></span>
<span class="line">                    <span class="token string">&quot;40-49 years old&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;50-59 years old&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;60-69 years old&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;more than 70 years old&quot;</span><span class="token punctuation">]</span></span>
<span class="line"></span>
<span class="line"><span class="token decorator annotation punctuation">@click<span class="token punctuation">.</span>command</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token decorator annotation punctuation">@click<span class="token punctuation">.</span>argument</span><span class="token punctuation">(</span><span class="token string">&#39;image_path&#39;</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">def</span> <span class="token function">case_face_detection_image</span><span class="token punctuation">(</span>image_path<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token triple-quoted-string string">&quot;&quot;&quot;</span>
<span class="line">    This is a sample application for face detection and tracking using an image.</span>
<span class="line">    It also includes pipeline extensions such as RGB liveness, mask detection, and face quality evaluation.</span>
<span class="line">    &quot;&quot;&quot;</span></span>
<span class="line">    <span class="token comment"># Optional features, loaded during session creation based on the modules specified.</span></span>
<span class="line">    opt <span class="token operator">=</span> isf<span class="token punctuation">.</span>HF_ENABLE_FACE_RECOGNITION <span class="token operator">|</span> isf<span class="token punctuation">.</span>HF_ENABLE_QUALITY <span class="token operator">|</span> isf<span class="token punctuation">.</span>HF_ENABLE_MASK_DETECT <span class="token operator">|</span> isf<span class="token punctuation">.</span>HF_ENABLE_LIVENESS <span class="token operator">|</span> isf<span class="token punctuation">.</span>HF_ENABLE_INTERACTION <span class="token operator">|</span> isf<span class="token punctuation">.</span>HF_ENABLE_FACE_ATTRIBUTE</span>
<span class="line">    session <span class="token operator">=</span> isf<span class="token punctuation">.</span>InspireFaceSession<span class="token punctuation">(</span>opt<span class="token punctuation">,</span> isf<span class="token punctuation">.</span>HF_DETECT_MODE_ALWAYS_DETECT<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">    <span class="token comment"># Set detection confidence threshold</span></span>
<span class="line">    session<span class="token punctuation">.</span>set_detection_confidence_threshold<span class="token punctuation">(</span><span class="token number">0.5</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">    <span class="token comment"># Load the image using OpenCV.</span></span>
<span class="line">    image <span class="token operator">=</span> cv2<span class="token punctuation">.</span>imread<span class="token punctuation">(</span>image_path<span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">assert</span> image <span class="token keyword">is</span> <span class="token keyword">not</span> <span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token string">&quot;Please check that the image path is correct.&quot;</span></span>
<span class="line"></span>
<span class="line">    <span class="token comment"># Perform face detection on the image.</span></span>
<span class="line">    faces <span class="token operator">=</span> session<span class="token punctuation">.</span>face_detection<span class="token punctuation">(</span>image<span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;face detection: </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token builtin">len</span><span class="token punctuation">(</span>faces<span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string"> found&quot;</span></span><span class="token punctuation">)</span></span>
<span class="line">    </span>
<span class="line">    <span class="token comment"># Copy the image for drawing the bounding boxes.</span></span>
<span class="line">    draw <span class="token operator">=</span> image<span class="token punctuation">.</span>copy<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">for</span> idx<span class="token punctuation">,</span> face <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>faces<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;</span><span class="token interpolation"><span class="token punctuation">{</span><span class="token string">&#39;==&#39;</span> <span class="token operator">*</span> <span class="token number">20</span><span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;idx: </span><span class="token interpolation"><span class="token punctuation">{</span>idx<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;detection confidence: </span><span class="token interpolation"><span class="token punctuation">{</span>face<span class="token punctuation">.</span>detection_confidence<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token comment"># Print Euler angles of the face.</span></span>
<span class="line">        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;roll: </span><span class="token interpolation"><span class="token punctuation">{</span>face<span class="token punctuation">.</span>roll<span class="token punctuation">}</span></span><span class="token string">, yaw: </span><span class="token interpolation"><span class="token punctuation">{</span>face<span class="token punctuation">.</span>yaw<span class="token punctuation">}</span></span><span class="token string">, pitch: </span><span class="token interpolation"><span class="token punctuation">{</span>face<span class="token punctuation">.</span>pitch<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">        <span class="token comment"># Get face bounding box</span></span>
<span class="line">        x1<span class="token punctuation">,</span> y1<span class="token punctuation">,</span> x2<span class="token punctuation">,</span> y2 <span class="token operator">=</span> face<span class="token punctuation">.</span>location</span>
<span class="line"></span>
<span class="line">        <span class="token comment"># Calculate center, size, and angle</span></span>
<span class="line">        center <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>x1 <span class="token operator">+</span> x2<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>y1 <span class="token operator">+</span> y2<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">)</span></span>
<span class="line">        size <span class="token operator">=</span> <span class="token punctuation">(</span>x2 <span class="token operator">-</span> x1<span class="token punctuation">,</span> y2 <span class="token operator">-</span> y1<span class="token punctuation">)</span></span>
<span class="line">        angle <span class="token operator">=</span> face<span class="token punctuation">.</span>roll</span>
<span class="line"></span>
<span class="line">        <span class="token comment"># Apply rotation to the bounding box corners</span></span>
<span class="line">        rect <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>center<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> center<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>size<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> size<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> angle<span class="token punctuation">)</span></span>
<span class="line">        box <span class="token operator">=</span> cv2<span class="token punctuation">.</span>boxPoints<span class="token punctuation">(</span>rect<span class="token punctuation">)</span></span>
<span class="line">        box <span class="token operator">=</span> box<span class="token punctuation">.</span>astype<span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">        <span class="token comment"># Draw the rotated bounding box</span></span>
<span class="line">        cv2<span class="token punctuation">.</span>drawContours<span class="token punctuation">(</span>draw<span class="token punctuation">,</span> <span class="token punctuation">[</span>box<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">180</span><span class="token punctuation">,</span> <span class="token number">29</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">        <span class="token comment"># Draw landmarks</span></span>
<span class="line">        lmk <span class="token operator">=</span> session<span class="token punctuation">.</span>get_face_dense_landmark<span class="token punctuation">(</span>face<span class="token punctuation">)</span></span>
<span class="line">        <span class="token keyword">for</span> x<span class="token punctuation">,</span> y <span class="token keyword">in</span> lmk<span class="token punctuation">.</span>astype<span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">            cv2<span class="token punctuation">.</span>circle<span class="token punctuation">(</span>draw<span class="token punctuation">,</span> <span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">220</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">    <span class="token comment"># Features must be enabled during session creation to use them here.</span></span>
<span class="line">    select_exec_func <span class="token operator">=</span> isf<span class="token punctuation">.</span>HF_ENABLE_QUALITY <span class="token operator">|</span> isf<span class="token punctuation">.</span>HF_ENABLE_MASK_DETECT <span class="token operator">|</span> isf<span class="token punctuation">.</span>HF_ENABLE_LIVENESS <span class="token operator">|</span> isf<span class="token punctuation">.</span>HF_ENABLE_INTERACTION <span class="token operator">|</span> isf<span class="token punctuation">.</span>HF_ENABLE_FACE_ATTRIBUTE</span>
<span class="line">    <span class="token comment"># Execute the pipeline to obtain richer face information.</span></span>
<span class="line">    extends <span class="token operator">=</span> session<span class="token punctuation">.</span>face_pipeline<span class="token punctuation">(</span>image<span class="token punctuation">,</span> faces<span class="token punctuation">,</span> select_exec_func<span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">for</span> idx<span class="token punctuation">,</span> ext <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>extends<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;</span><span class="token interpolation"><span class="token punctuation">{</span><span class="token string">&#39;==&#39;</span> <span class="token operator">*</span> <span class="token number">20</span><span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;idx: </span><span class="token interpolation"><span class="token punctuation">{</span>idx<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token comment"># For these pipeline results, you can set thresholds based on the specific scenario to make judgments.</span></span>
<span class="line">        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;quality: </span><span class="token interpolation"><span class="token punctuation">{</span>ext<span class="token punctuation">.</span>quality_confidence<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;rgb liveness: </span><span class="token interpolation"><span class="token punctuation">{</span>ext<span class="token punctuation">.</span>rgb_liveness_confidence<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;face mask: </span><span class="token interpolation"><span class="token punctuation">{</span>ext<span class="token punctuation">.</span>mask_confidence<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token keyword">print</span><span class="token punctuation">(</span></span>
<span class="line">            <span class="token string-interpolation"><span class="token string">f&quot;face eyes status: left eye: </span><span class="token interpolation"><span class="token punctuation">{</span>ext<span class="token punctuation">.</span>left_eye_status_confidence<span class="token punctuation">}</span></span><span class="token string"> right eye: </span><span class="token interpolation"><span class="token punctuation">{</span>ext<span class="token punctuation">.</span>right_eye_status_confidence<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;gender: </span><span class="token interpolation"><span class="token punctuation">{</span>gender_tags<span class="token punctuation">[</span>ext<span class="token punctuation">.</span>gender<span class="token punctuation">]</span><span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;race: </span><span class="token interpolation"><span class="token punctuation">{</span>race_tags<span class="token punctuation">[</span>ext<span class="token punctuation">.</span>race<span class="token punctuation">]</span><span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;age: </span><span class="token interpolation"><span class="token punctuation">{</span>age_bracket_tags<span class="token punctuation">[</span>ext<span class="token punctuation">.</span>age_bracket<span class="token punctuation">]</span><span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">    <span class="token comment"># Save the annotated image to the &#39;tmp/&#39; directory.</span></span>
<span class="line">    save_path <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token string">&quot;tmp/&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;det.jpg&quot;</span><span class="token punctuation">)</span></span>
<span class="line">    cv2<span class="token punctuation">.</span>imwrite<span class="token punctuation">(</span>save_path<span class="token punctuation">,</span> draw<span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;\\nSave annotated image to </span><span class="token interpolation"><span class="token punctuation">{</span>save_path<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">&#39;__main__&#39;</span><span class="token punctuation">:</span></span>
<span class="line">    os<span class="token punctuation">.</span>makedirs<span class="token punctuation">(</span><span class="token string">&quot;tmp&quot;</span><span class="token punctuation">,</span> exist_ok<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span></span>
<span class="line">    case_face_detection_image<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="example-face-comparison" tabindex="-1"><a class="header-anchor" href="#example-face-comparison"><span>[Example]Face Comparison</span></a></h2><p>Face comparison 1:1 use case:</p><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py"><pre><code><span class="line"><span class="token keyword">import</span> cv2</span>
<span class="line"><span class="token keyword">import</span> inspireface <span class="token keyword">as</span> isf</span>
<span class="line"><span class="token keyword">import</span> click</span>
<span class="line"></span>
<span class="line"><span class="token decorator annotation punctuation">@click<span class="token punctuation">.</span>command</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token decorator annotation punctuation">@click<span class="token punctuation">.</span>argument</span><span class="token punctuation">(</span><span class="token string">&#39;image_path1&#39;</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token decorator annotation punctuation">@click<span class="token punctuation">.</span>argument</span><span class="token punctuation">(</span><span class="token string">&#39;image_path2&#39;</span><span class="token punctuation">)</span> </span>
<span class="line"><span class="token keyword">def</span> <span class="token function">case_face_comparison</span><span class="token punctuation">(</span>image_path1<span class="token punctuation">,</span> image_path2<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token triple-quoted-string string">&quot;&quot;&quot;</span>
<span class="line">    This is a sample application for comparing two face images.</span>
<span class="line">    Args:</span>
<span class="line">        image_path1 (str): Path to the first face image</span>
<span class="line">        image_path2 (str): Path to the second face image</span>
<span class="line">    &quot;&quot;&quot;</span></span>
<span class="line">    <span class="token comment"># Enable face recognition features</span></span>
<span class="line">    opt <span class="token operator">=</span> isf<span class="token punctuation">.</span>HF_ENABLE_FACE_RECOGNITION</span>
<span class="line">    session <span class="token operator">=</span> isf<span class="token punctuation">.</span>InspireFaceSession<span class="token punctuation">(</span>opt<span class="token punctuation">,</span> isf<span class="token punctuation">.</span>HF_DETECT_MODE_ALWAYS_DETECT<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">    <span class="token comment"># Load and check the first image</span></span>
<span class="line">    image1 <span class="token operator">=</span> cv2<span class="token punctuation">.</span>imread<span class="token punctuation">(</span>image_path1<span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">assert</span> image1 <span class="token keyword">is</span> <span class="token keyword">not</span> <span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token string">&quot;Failed to load first image&quot;</span></span>
<span class="line">    </span>
<span class="line">    <span class="token comment"># Load and check the second image  </span></span>
<span class="line">    image2 <span class="token operator">=</span> cv2<span class="token punctuation">.</span>imread<span class="token punctuation">(</span>image_path2<span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">assert</span> image2 <span class="token keyword">is</span> <span class="token keyword">not</span> <span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token string">&quot;Failed to load second image&quot;</span></span>
<span class="line"></span>
<span class="line">    <span class="token comment"># Detect faces in first image</span></span>
<span class="line">    faces1 <span class="token operator">=</span> session<span class="token punctuation">.</span>face_detection<span class="token punctuation">(</span>image1<span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">assert</span> faces1<span class="token punctuation">,</span> <span class="token string">&quot;No face detected in first image&quot;</span></span>
<span class="line">    face1 <span class="token operator">=</span> faces1<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>  <span class="token comment"># Use the first detected face</span></span>
<span class="line"></span>
<span class="line">    <span class="token comment"># Detect faces in second image</span></span>
<span class="line">    faces2 <span class="token operator">=</span> session<span class="token punctuation">.</span>face_detection<span class="token punctuation">(</span>image2<span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">assert</span> faces2<span class="token punctuation">,</span> <span class="token string">&quot;No face detected in second image&quot;</span></span>
<span class="line">    face2 <span class="token operator">=</span> faces2<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>  <span class="token comment"># Use the first detected face</span></span>
<span class="line"></span>
<span class="line">    <span class="token comment"># Extract features</span></span>
<span class="line">    feature1 <span class="token operator">=</span> session<span class="token punctuation">.</span>face_feature_extract<span class="token punctuation">(</span>image1<span class="token punctuation">,</span> face1<span class="token punctuation">)</span></span>
<span class="line">    feature2 <span class="token operator">=</span> session<span class="token punctuation">.</span>face_feature_extract<span class="token punctuation">(</span>image2<span class="token punctuation">,</span> face2<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">    <span class="token comment"># Calculate similarity score between the two faces</span></span>
<span class="line">    similarity <span class="token operator">=</span> isf<span class="token punctuation">.</span>feature_comparison<span class="token punctuation">(</span>feature1<span class="token punctuation">,</span> feature2<span class="token punctuation">)</span></span>
<span class="line">    </span>
<span class="line">    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;The cosine similarity score: </span><span class="token interpolation"><span class="token punctuation">{</span>similarity<span class="token punctuation">:</span><span class="token format-spec">.4f</span><span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;</span><span class="token interpolation"><span class="token punctuation">{</span><span class="token string">&#39;Same person&#39;</span> <span class="token keyword">if</span> similarity <span class="token operator">&gt;</span> isf<span class="token punctuation">.</span>get_recommended_cosine_threshold<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">else</span> <span class="token string">&#39;Different person&#39;</span><span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">    percentage <span class="token operator">=</span> isf<span class="token punctuation">.</span>cosine_similarity_convert_to_percentage<span class="token punctuation">(</span>similarity<span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;The percentage similarity: </span><span class="token interpolation"><span class="token punctuation">{</span>percentage<span class="token punctuation">:</span><span class="token format-spec">.4f</span><span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">&#39;__main__&#39;</span><span class="token punctuation">:</span></span>
<span class="line">    case_face_comparison<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="more" tabindex="-1"><a class="header-anchor" href="#more"><span>More</span></a></h2><p>TODO</p>`,17)]))}const l=s(e,[["render",o]]),u=JSON.parse('{"path":"/using-with/python.html","title":"Using InspireFace in Python","lang":"en-US","frontmatter":{},"headers":[{"level":2,"title":"Installation and Setup","slug":"installation-and-setup","link":"#installation-and-setup","children":[]},{"level":2,"title":"How to switch models","slug":"how-to-switch-models","link":"#how-to-switch-models","children":[]},{"level":2,"title":"[Example]Face Detect and Pipeline","slug":"example-face-detect-and-pipeline","link":"#example-face-detect-and-pipeline","children":[]},{"level":2,"title":"[Example]Face Comparison","slug":"example-face-comparison","link":"#example-face-comparison","children":[]},{"level":2,"title":"More","slug":"more","link":"#more","children":[]}],"git":{"updatedTime":1744186586000,"contributors":[{"name":"tunm","username":"tunm","email":"tunmxy@163.com","commits":4,"url":"https://github.com/tunm"}],"changelog":[{"hash":"4210a21023962524fb284ab4236a728e23ca653e","time":1744186586000,"email":"tunmxy@163.com","author":"tunm","message":"Update"},{"hash":"00473c2c94170ac17df87e27a68c633b9151a414","time":1744185861000,"email":"tunmxy@163.com","author":"tunm","message":"Update"},{"hash":"36283da830e3e7efee25add2666d4a49dae22fa8","time":1744178190000,"email":"tunmxy@163.com","author":"tunm","message":"Update"},{"hash":"b1bdfb0435ebc29849c32dd85a92e67161a23726","time":1744160796000,"email":"tunmxy@163.com","author":"tunm","message":"Update"}]},"filePathRelative":"using-with/python.md"}');export{l as comp,u as data};
