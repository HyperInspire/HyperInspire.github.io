<!doctype html>
<html lang="en-US">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-rc.20" />
    <style>
      :root {
        --vp-c-bg: #fff;
      }

      [data-theme='dark'] {
        --vp-c-bg: #1b1b1f;
      }

      html,
      body {
        background-color: var(--vp-c-bg);
      }
    </style>
    <script>
      const useChoice = localStorage.getItem('vuepress-color-scheme')
      const systemStatus =
        'matchMedia' in window
          ? window.matchMedia('(prefers-color-scheme: dark)').matches
          : false

      if (useChoice === 'light') {
        document.documentElement.dataset.theme = 'light'
      } else if (useChoice === 'dark' || systemStatus) {
        document.documentElement.dataset.theme = 'dark'
      }
    </script>
    <link rel="icon" href="https://tunm-resource.oss-cn-hongkong.aliyuncs.com/blogs_box/favicon32.jpg"><title>Using InspireFace in Python | InspireFace</title><meta name="description" content="A cross-platform high-performance deep learning facial analysis SDK framework.">
    <link rel="preload" href="/assets/style-B3-VMakp.css" as="style"><link rel="stylesheet" href="/assets/style-B3-VMakp.css">
    <link rel="modulepreload" href="/assets/app-Cilg8IT4.js"><link rel="modulepreload" href="/assets/python.html-CsCfzC0Z.js">
    <link rel="prefetch" href="/assets/index.html-BpTt2gNv.js" as="script"><link rel="prefetch" href="/assets/feature.html-DLVHty9A.js" as="script"><link rel="prefetch" href="/assets/get-started.html-BS5GkFkw.js" as="script"><link rel="prefetch" href="/assets/introduction.html-CdFgT6-L.js" as="script"><link rel="prefetch" href="/assets/arch.html-DXmCzlsg.js" as="script"><link rel="prefetch" href="/assets/dense-landmark.html-Dc_oZq01.js" as="script"><link rel="prefetch" href="/assets/inspirecv.html-DA0OnwF3.js" as="script"><link rel="prefetch" href="/assets/android.html-D4T3J22a.js" as="script"><link rel="prefetch" href="/assets/c-cpp.html-CvmcVcvb.js" as="script"><link rel="prefetch" href="/assets/cpp.html-DgtKD02S.js" as="script"><link rel="prefetch" href="/assets/cuda.html-BUPDiNYo.js" as="script"><link rel="prefetch" href="/assets/ios.html-D-hvv7ib.js" as="script"><link rel="prefetch" href="/assets/rknpu.html-BSln3LnL.js" as="script"><link rel="prefetch" href="/assets/404.html-DzD-B2m6.js" as="script">
  </head>
  <body>
    <div id="app"><!--[--><div class="vp-theme-container external-link-icon" vp-container><!--[--><header class="vp-navbar" vp-navbar><div class="vp-toggle-sidebar-button" title="toggle sidebar" aria-expanded="false" role="button" tabindex="0"><div class="icon" aria-hidden="true"><span></span><span></span><span></span></div></div><span><a class="route-link" href="/"><img class="vp-site-logo" src="https://tunm-resource.oss-cn-hongkong.aliyuncs.com/docs/126000993.png" alt="InspireFace"><span class="vp-site-name vp-hide-mobile" aria-hidden="true">InspireFace</span></a></span><div class="vp-navbar-items-wrapper" style=""><!--[--><!--]--><nav class="vp-navbar-items vp-hide-mobile" aria-label="site navigation"><!--[--><div class="vp-navbar-item"><a class="route-link auto-link" href="/" aria-label="Home"><!--[--><!--[--><!--]--><!--]-->Home<!--[--><!--[--><!--]--><!--]--></a></div><div class="vp-navbar-item"><a class="route-link auto-link" href="/get-started.html" aria-label="Get Started"><!--[--><!--[--><!--]--><!--]-->Get Started<!--[--><!--[--><!--]--><!--]--></a></div><!--]--></nav><!--[--><!--]--><button type="button" class="vp-toggle-color-mode-button" title="toggle color mode"><svg class="light-icon" viewbox="0 0 32 32" style=""><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg><svg class="dark-icon" viewbox="0 0 32 32" style="display:none;"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></button><!----></div></header><!--]--><div class="vp-sidebar-mask"></div><!--[--><aside class="vp-sidebar" vp-sidebar><nav class="vp-navbar-items" aria-label="site navigation"><!--[--><div class="vp-navbar-item"><a class="route-link auto-link" href="/" aria-label="Home"><!--[--><!--[--><!--]--><!--]-->Home<!--[--><!--[--><!--]--><!--]--></a></div><div class="vp-navbar-item"><a class="route-link auto-link" href="/get-started.html" aria-label="Get Started"><!--[--><!--[--><!--]--><!--]-->Get Started<!--[--><!--[--><!--]--><!--]--></a></div><!--]--></nav><!--[--><!--]--><ul class="vp-sidebar-items"><!--[--><li><a class="route-link auto-link vp-sidebar-item vp-sidebar-heading" href="/introduction.html" aria-label="Introduction"><!--[--><!--[--><!--]--><!--]-->Introduction<!--[--><!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link auto-link vp-sidebar-item vp-sidebar-heading" href="/get-started.html" aria-label="Get Started"><!--[--><!--[--><!--]--><!--]-->Get Started<!--[--><!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link auto-link vp-sidebar-item vp-sidebar-heading" href="/feature.html" aria-label="Feature"><!--[--><!--[--><!--]--><!--]-->Feature<!--[--><!--[--><!--]--><!--]--></a><!----></li><li><p tabindex="0" class="vp-sidebar-item vp-sidebar-heading active">Using with <!----></p><ul style="" class="vp-sidebar-children"><!--[--><li><a class="route-link auto-link vp-sidebar-item" href="/using-with/c-cpp.html" aria-label="C/C++"><!--[--><!--[--><!--]--><!--]-->C/C++<!--[--><!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/using-with/cpp.html" aria-label="C++"><!--[--><!--[--><!--]--><!--]-->C++<!--[--><!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link route-link-active auto-link vp-sidebar-item active" href="/using-with/python.html" aria-label="Python"><!--[--><!--[--><!--]--><!--]-->Python<!--[--><!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/using-with/android.html" aria-label="Android"><!--[--><!--[--><!--]--><!--]-->Android<!--[--><!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/using-with/ios.html" aria-label="iOS"><!--[--><!--[--><!--]--><!--]-->iOS<!--[--><!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/using-with/cuda.html" aria-label="CUDA"><!--[--><!--[--><!--]--><!--]-->CUDA<!--[--><!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/using-with/rknpu.html" aria-label="Rockchip NPU"><!--[--><!--[--><!--]--><!--]-->Rockchip NPU<!--[--><!--[--><!--]--><!--]--></a><!----></li><!--]--></ul></li><li><p tabindex="0" class="vp-sidebar-item vp-sidebar-heading">Guides <!----></p><ul style="" class="vp-sidebar-children"><!--[--><li><a class="route-link auto-link vp-sidebar-item" href="/guides/arch.html" aria-label="Architecture"><!--[--><!--[--><!--]--><!--]-->Architecture<!--[--><!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/guides/dense-landmark.html" aria-label="Dense Landmark"><!--[--><!--[--><!--]--><!--]-->Dense Landmark<!--[--><!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/guides/inspirecv.html" aria-label="Lightweight CV library"><!--[--><!--[--><!--]--><!--]-->Lightweight CV library<!--[--><!--[--><!--]--><!--]--></a><!----></li><!--]--></ul></li><!--]--></ul><!--[--><!--]--></aside><!--]--><!--[--><main class="vp-page"><!--[--><!--]--><div vp-content><!--[--><!--]--><div><h1 id="using-inspireface-in-python" tabindex="-1"><a class="header-anchor" href="#using-inspireface-in-python"><span>Using InspireFace in Python</span></a></h1><p>The python version of inspireface is based on ctypes and the standard edition of InspireFaceSDK libraries, and usually requires <strong>python &gt;= 3.7</strong>.</p><div class="hint-container warning"><p class="hint-container-title">Warning</p><p>If you install inspireface from pypi, it is usually a regular version that <strong>only supports the cpu</strong> version. If you want to build python based on CUDA, Rockchip NPU, ANE inference backend, you will need to re-adapt the corresponding version of the library to the Python project. See the repository for <a href="https://github.com/HyperInspire/InspireFace/tree/master/python" target="_blank" rel="noopener noreferrer">more details</a>.</p></div><h2 id="installation-and-setup" tabindex="-1"><a class="header-anchor" href="#installation-and-setup"><span>Installation and Setup</span></a></h2><p>You can use pip to install the InspireFace Python package:</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code><span class="line">pip <span class="token function">install</span> <span class="token parameter variable">-U</span> inspireface</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h2 id="how-to-switch-models" tabindex="-1"><a class="header-anchor" href="#how-to-switch-models"><span>How to switch models</span></a></h2><p>You can start or restart global initialization with the reload function. You can use model_name to specify the model to use, such as Pikachu or Megatron, or you can use the resource_path parameter to specify a model path.</p><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py"><pre><code><span class="line"><span class="token keyword">import</span> inspireface <span class="token keyword">as</span> isf</span>
<span class="line"></span>
<span class="line"><span class="token comment"># Will download automatically</span></span>
<span class="line">isf<span class="token punctuation">.</span><span class="token builtin">reload</span><span class="token punctuation">(</span>model_name<span class="token operator">=</span><span class="token string">&#39;Pikachu&#39;</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># Direct use path</span></span>
<span class="line">isf<span class="token punctuation">.</span><span class="token builtin">reload</span><span class="token punctuation">(</span>model_name<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> resource_path<span class="token operator">=</span><span class="token string">&quot;/home/user/Pikachu&quot;</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="example-face-detect-and-pipeline" tabindex="-1"><a class="header-anchor" href="#example-face-detect-and-pipeline"><span>[Example]Face Detect and Pipeline</span></a></h2><p>Face detection and some use cases of face attribute analysis:</p><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py"><pre><code><span class="line"><span class="token keyword">import</span> os</span>
<span class="line"><span class="token keyword">import</span> cv2</span>
<span class="line"><span class="token keyword">import</span> inspireface <span class="token keyword">as</span> isf</span>
<span class="line"><span class="token keyword">import</span> click</span>
<span class="line"><span class="token keyword">import</span> numpy <span class="token keyword">as</span> np</span>
<span class="line"></span>
<span class="line">race_tags <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">&quot;Black&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Asian&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Latino/Hispanic&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Middle Eastern&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;White&quot;</span><span class="token punctuation">]</span></span>
<span class="line">gender_tags <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">&quot;Female&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Male&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">]</span></span>
<span class="line">age_bracket_tags <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">&quot;0-2 years old&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;3-9 years old&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;10-19 years old&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;20-29 years old&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;30-39 years old&quot;</span><span class="token punctuation">,</span></span>
<span class="line">                    <span class="token string">&quot;40-49 years old&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;50-59 years old&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;60-69 years old&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;more than 70 years old&quot;</span><span class="token punctuation">]</span></span>
<span class="line"></span>
<span class="line"><span class="token decorator annotation punctuation">@click<span class="token punctuation">.</span>command</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token decorator annotation punctuation">@click<span class="token punctuation">.</span>argument</span><span class="token punctuation">(</span><span class="token string">&#39;image_path&#39;</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token keyword">def</span> <span class="token function">case_face_detection_image</span><span class="token punctuation">(</span>image_path<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token triple-quoted-string string">&quot;&quot;&quot;</span>
<span class="line">    This is a sample application for face detection and tracking using an image.</span>
<span class="line">    It also includes pipeline extensions such as RGB liveness, mask detection, and face quality evaluation.</span>
<span class="line">    &quot;&quot;&quot;</span></span>
<span class="line">    <span class="token comment"># Optional features, loaded during session creation based on the modules specified.</span></span>
<span class="line">    opt <span class="token operator">=</span> isf<span class="token punctuation">.</span>HF_ENABLE_FACE_RECOGNITION <span class="token operator">|</span> isf<span class="token punctuation">.</span>HF_ENABLE_QUALITY <span class="token operator">|</span> isf<span class="token punctuation">.</span>HF_ENABLE_MASK_DETECT <span class="token operator">|</span> isf<span class="token punctuation">.</span>HF_ENABLE_LIVENESS <span class="token operator">|</span> isf<span class="token punctuation">.</span>HF_ENABLE_INTERACTION <span class="token operator">|</span> isf<span class="token punctuation">.</span>HF_ENABLE_FACE_ATTRIBUTE</span>
<span class="line">    session <span class="token operator">=</span> isf<span class="token punctuation">.</span>InspireFaceSession<span class="token punctuation">(</span>opt<span class="token punctuation">,</span> isf<span class="token punctuation">.</span>HF_DETECT_MODE_ALWAYS_DETECT<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">    <span class="token comment"># Set detection confidence threshold</span></span>
<span class="line">    session<span class="token punctuation">.</span>set_detection_confidence_threshold<span class="token punctuation">(</span><span class="token number">0.5</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">    <span class="token comment"># Load the image using OpenCV.</span></span>
<span class="line">    image <span class="token operator">=</span> cv2<span class="token punctuation">.</span>imread<span class="token punctuation">(</span>image_path<span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">assert</span> image <span class="token keyword">is</span> <span class="token keyword">not</span> <span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token string">&quot;Please check that the image path is correct.&quot;</span></span>
<span class="line"></span>
<span class="line">    <span class="token comment"># Perform face detection on the image.</span></span>
<span class="line">    faces <span class="token operator">=</span> session<span class="token punctuation">.</span>face_detection<span class="token punctuation">(</span>image<span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;face detection: </span><span class="token interpolation"><span class="token punctuation">{</span><span class="token builtin">len</span><span class="token punctuation">(</span>faces<span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token string"> found&quot;</span></span><span class="token punctuation">)</span></span>
<span class="line">    </span>
<span class="line">    <span class="token comment"># Copy the image for drawing the bounding boxes.</span></span>
<span class="line">    draw <span class="token operator">=</span> image<span class="token punctuation">.</span>copy<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">for</span> idx<span class="token punctuation">,</span> face <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>faces<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;</span><span class="token interpolation"><span class="token punctuation">{</span><span class="token string">&#39;==&#39;</span> <span class="token operator">*</span> <span class="token number">20</span><span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;idx: </span><span class="token interpolation"><span class="token punctuation">{</span>idx<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;detection confidence: </span><span class="token interpolation"><span class="token punctuation">{</span>face<span class="token punctuation">.</span>detection_confidence<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token comment"># Print Euler angles of the face.</span></span>
<span class="line">        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;roll: </span><span class="token interpolation"><span class="token punctuation">{</span>face<span class="token punctuation">.</span>roll<span class="token punctuation">}</span></span><span class="token string">, yaw: </span><span class="token interpolation"><span class="token punctuation">{</span>face<span class="token punctuation">.</span>yaw<span class="token punctuation">}</span></span><span class="token string">, pitch: </span><span class="token interpolation"><span class="token punctuation">{</span>face<span class="token punctuation">.</span>pitch<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">        <span class="token comment"># Get face bounding box</span></span>
<span class="line">        x1<span class="token punctuation">,</span> y1<span class="token punctuation">,</span> x2<span class="token punctuation">,</span> y2 <span class="token operator">=</span> face<span class="token punctuation">.</span>location</span>
<span class="line"></span>
<span class="line">        <span class="token comment"># Calculate center, size, and angle</span></span>
<span class="line">        center <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>x1 <span class="token operator">+</span> x2<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>y1 <span class="token operator">+</span> y2<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">)</span></span>
<span class="line">        size <span class="token operator">=</span> <span class="token punctuation">(</span>x2 <span class="token operator">-</span> x1<span class="token punctuation">,</span> y2 <span class="token operator">-</span> y1<span class="token punctuation">)</span></span>
<span class="line">        angle <span class="token operator">=</span> face<span class="token punctuation">.</span>roll</span>
<span class="line"></span>
<span class="line">        <span class="token comment"># Apply rotation to the bounding box corners</span></span>
<span class="line">        rect <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>center<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> center<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>size<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> size<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> angle<span class="token punctuation">)</span></span>
<span class="line">        box <span class="token operator">=</span> cv2<span class="token punctuation">.</span>boxPoints<span class="token punctuation">(</span>rect<span class="token punctuation">)</span></span>
<span class="line">        box <span class="token operator">=</span> box<span class="token punctuation">.</span>astype<span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">        <span class="token comment"># Draw the rotated bounding box</span></span>
<span class="line">        cv2<span class="token punctuation">.</span>drawContours<span class="token punctuation">(</span>draw<span class="token punctuation">,</span> <span class="token punctuation">[</span>box<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">180</span><span class="token punctuation">,</span> <span class="token number">29</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">        <span class="token comment"># Draw landmarks</span></span>
<span class="line">        lmk <span class="token operator">=</span> session<span class="token punctuation">.</span>get_face_dense_landmark<span class="token punctuation">(</span>face<span class="token punctuation">)</span></span>
<span class="line">        <span class="token keyword">for</span> x<span class="token punctuation">,</span> y <span class="token keyword">in</span> lmk<span class="token punctuation">.</span>astype<span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">            cv2<span class="token punctuation">.</span>circle<span class="token punctuation">(</span>draw<span class="token punctuation">,</span> <span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">220</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">    <span class="token comment"># Features must be enabled during session creation to use them here.</span></span>
<span class="line">    select_exec_func <span class="token operator">=</span> isf<span class="token punctuation">.</span>HF_ENABLE_QUALITY <span class="token operator">|</span> isf<span class="token punctuation">.</span>HF_ENABLE_MASK_DETECT <span class="token operator">|</span> isf<span class="token punctuation">.</span>HF_ENABLE_LIVENESS <span class="token operator">|</span> isf<span class="token punctuation">.</span>HF_ENABLE_INTERACTION <span class="token operator">|</span> isf<span class="token punctuation">.</span>HF_ENABLE_FACE_ATTRIBUTE</span>
<span class="line">    <span class="token comment"># Execute the pipeline to obtain richer face information.</span></span>
<span class="line">    extends <span class="token operator">=</span> session<span class="token punctuation">.</span>face_pipeline<span class="token punctuation">(</span>image<span class="token punctuation">,</span> faces<span class="token punctuation">,</span> select_exec_func<span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">for</span> idx<span class="token punctuation">,</span> ext <span class="token keyword">in</span> <span class="token builtin">enumerate</span><span class="token punctuation">(</span>extends<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;</span><span class="token interpolation"><span class="token punctuation">{</span><span class="token string">&#39;==&#39;</span> <span class="token operator">*</span> <span class="token number">20</span><span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;idx: </span><span class="token interpolation"><span class="token punctuation">{</span>idx<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token comment"># For these pipeline results, you can set thresholds based on the specific scenario to make judgments.</span></span>
<span class="line">        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;quality: </span><span class="token interpolation"><span class="token punctuation">{</span>ext<span class="token punctuation">.</span>quality_confidence<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;rgb liveness: </span><span class="token interpolation"><span class="token punctuation">{</span>ext<span class="token punctuation">.</span>rgb_liveness_confidence<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;face mask: </span><span class="token interpolation"><span class="token punctuation">{</span>ext<span class="token punctuation">.</span>mask_confidence<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token keyword">print</span><span class="token punctuation">(</span></span>
<span class="line">            <span class="token string-interpolation"><span class="token string">f&quot;face eyes status: left eye: </span><span class="token interpolation"><span class="token punctuation">{</span>ext<span class="token punctuation">.</span>left_eye_status_confidence<span class="token punctuation">}</span></span><span class="token string"> right eye: </span><span class="token interpolation"><span class="token punctuation">{</span>ext<span class="token punctuation">.</span>right_eye_status_confidence<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;gender: </span><span class="token interpolation"><span class="token punctuation">{</span>gender_tags<span class="token punctuation">[</span>ext<span class="token punctuation">.</span>gender<span class="token punctuation">]</span><span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;race: </span><span class="token interpolation"><span class="token punctuation">{</span>race_tags<span class="token punctuation">[</span>ext<span class="token punctuation">.</span>race<span class="token punctuation">]</span><span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;age: </span><span class="token interpolation"><span class="token punctuation">{</span>age_bracket_tags<span class="token punctuation">[</span>ext<span class="token punctuation">.</span>age_bracket<span class="token punctuation">]</span><span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">    <span class="token comment"># Save the annotated image to the &#39;tmp/&#39; directory.</span></span>
<span class="line">    save_path <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token string">&quot;tmp/&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;det.jpg&quot;</span><span class="token punctuation">)</span></span>
<span class="line">    cv2<span class="token punctuation">.</span>imwrite<span class="token punctuation">(</span>save_path<span class="token punctuation">,</span> draw<span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;\nSave annotated image to </span><span class="token interpolation"><span class="token punctuation">{</span>save_path<span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">&#39;__main__&#39;</span><span class="token punctuation">:</span></span>
<span class="line">    os<span class="token punctuation">.</span>makedirs<span class="token punctuation">(</span><span class="token string">&quot;tmp&quot;</span><span class="token punctuation">,</span> exist_ok<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span></span>
<span class="line">    case_face_detection_image<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="example-face-comparison" tabindex="-1"><a class="header-anchor" href="#example-face-comparison"><span>[Example]Face Comparison</span></a></h2><p>Face comparison 1:1 use case:</p><div class="language-python line-numbers-mode" data-highlighter="prismjs" data-ext="py"><pre><code><span class="line"><span class="token keyword">import</span> cv2</span>
<span class="line"><span class="token keyword">import</span> inspireface <span class="token keyword">as</span> isf</span>
<span class="line"><span class="token keyword">import</span> click</span>
<span class="line"></span>
<span class="line"><span class="token decorator annotation punctuation">@click<span class="token punctuation">.</span>command</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token decorator annotation punctuation">@click<span class="token punctuation">.</span>argument</span><span class="token punctuation">(</span><span class="token string">&#39;image_path1&#39;</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token decorator annotation punctuation">@click<span class="token punctuation">.</span>argument</span><span class="token punctuation">(</span><span class="token string">&#39;image_path2&#39;</span><span class="token punctuation">)</span> </span>
<span class="line"><span class="token keyword">def</span> <span class="token function">case_face_comparison</span><span class="token punctuation">(</span>image_path1<span class="token punctuation">,</span> image_path2<span class="token punctuation">)</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token triple-quoted-string string">&quot;&quot;&quot;</span>
<span class="line">    This is a sample application for comparing two face images.</span>
<span class="line">    Args:</span>
<span class="line">        image_path1 (str): Path to the first face image</span>
<span class="line">        image_path2 (str): Path to the second face image</span>
<span class="line">    &quot;&quot;&quot;</span></span>
<span class="line">    <span class="token comment"># Enable face recognition features</span></span>
<span class="line">    opt <span class="token operator">=</span> isf<span class="token punctuation">.</span>HF_ENABLE_FACE_RECOGNITION</span>
<span class="line">    session <span class="token operator">=</span> isf<span class="token punctuation">.</span>InspireFaceSession<span class="token punctuation">(</span>opt<span class="token punctuation">,</span> isf<span class="token punctuation">.</span>HF_DETECT_MODE_ALWAYS_DETECT<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">    <span class="token comment"># Load and check the first image</span></span>
<span class="line">    image1 <span class="token operator">=</span> cv2<span class="token punctuation">.</span>imread<span class="token punctuation">(</span>image_path1<span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">assert</span> image1 <span class="token keyword">is</span> <span class="token keyword">not</span> <span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token string">&quot;Failed to load first image&quot;</span></span>
<span class="line">    </span>
<span class="line">    <span class="token comment"># Load and check the second image  </span></span>
<span class="line">    image2 <span class="token operator">=</span> cv2<span class="token punctuation">.</span>imread<span class="token punctuation">(</span>image_path2<span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">assert</span> image2 <span class="token keyword">is</span> <span class="token keyword">not</span> <span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token string">&quot;Failed to load second image&quot;</span></span>
<span class="line"></span>
<span class="line">    <span class="token comment"># Detect faces in first image</span></span>
<span class="line">    faces1 <span class="token operator">=</span> session<span class="token punctuation">.</span>face_detection<span class="token punctuation">(</span>image1<span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">assert</span> faces1<span class="token punctuation">,</span> <span class="token string">&quot;No face detected in first image&quot;</span></span>
<span class="line">    face1 <span class="token operator">=</span> faces1<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>  <span class="token comment"># Use the first detected face</span></span>
<span class="line"></span>
<span class="line">    <span class="token comment"># Detect faces in second image</span></span>
<span class="line">    faces2 <span class="token operator">=</span> session<span class="token punctuation">.</span>face_detection<span class="token punctuation">(</span>image2<span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">assert</span> faces2<span class="token punctuation">,</span> <span class="token string">&quot;No face detected in second image&quot;</span></span>
<span class="line">    face2 <span class="token operator">=</span> faces2<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>  <span class="token comment"># Use the first detected face</span></span>
<span class="line"></span>
<span class="line">    <span class="token comment"># Extract features</span></span>
<span class="line">    feature1 <span class="token operator">=</span> session<span class="token punctuation">.</span>face_feature_extract<span class="token punctuation">(</span>image1<span class="token punctuation">,</span> face1<span class="token punctuation">)</span></span>
<span class="line">    feature2 <span class="token operator">=</span> session<span class="token punctuation">.</span>face_feature_extract<span class="token punctuation">(</span>image2<span class="token punctuation">,</span> face2<span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">    <span class="token comment"># Calculate similarity score between the two faces</span></span>
<span class="line">    similarity <span class="token operator">=</span> isf<span class="token punctuation">.</span>feature_comparison<span class="token punctuation">(</span>feature1<span class="token punctuation">,</span> feature2<span class="token punctuation">)</span></span>
<span class="line">    </span>
<span class="line">    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;The cosine similarity score: </span><span class="token interpolation"><span class="token punctuation">{</span>similarity<span class="token punctuation">:</span><span class="token format-spec">.4f</span><span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;</span><span class="token interpolation"><span class="token punctuation">{</span><span class="token string">&#39;Same person&#39;</span> <span class="token keyword">if</span> similarity <span class="token operator">&gt;</span> isf<span class="token punctuation">.</span>get_recommended_cosine_threshold<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">else</span> <span class="token string">&#39;Different person&#39;</span><span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">    percentage <span class="token operator">=</span> isf<span class="token punctuation">.</span>cosine_similarity_convert_to_percentage<span class="token punctuation">(</span>similarity<span class="token punctuation">)</span></span>
<span class="line">    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f&quot;The percentage similarity: </span><span class="token interpolation"><span class="token punctuation">{</span>percentage<span class="token punctuation">:</span><span class="token format-spec">.4f</span><span class="token punctuation">}</span></span><span class="token string">&quot;</span></span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">&#39;__main__&#39;</span><span class="token punctuation">:</span></span>
<span class="line">    case_face_comparison<span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="more" tabindex="-1"><a class="header-anchor" href="#more"><span>More</span></a></h2><p>TODO</p></div><!--[--><!--]--></div><footer class="vp-page-meta"><!----><div class="vp-meta-item git-info"><div class="vp-meta-item last-updated"><span class="meta-item-label">Last Updated:: </span><time class="meta-item-info" datetime="2025-04-09T08:16:26.000Z" data-allow-mismatch>4/9/25, 8:16 AM</time></div><div class="vp-meta-item contributors"><span class="meta-item-label">Contributors: </span><span class="meta-item-info"><!--[--><!--[--><span class="contributor" title="email: tunmxy@163.com">tunm</span><!----><!--]--><!--]--></span></div></div></footer><nav class="vp-page-nav" aria-label="page navigation"><a class="route-link auto-link prev" href="/using-with/cpp.html" aria-label="C++"><!--[--><div class="hint"><span class="arrow left"></span> Prev</div><div class="link"><span class="external-link">C++</span></div><!--]--></a><a class="route-link auto-link next" href="/using-with/android.html" aria-label="Android"><!--[--><div class="hint">Next <span class="arrow right"></span></div><div class="link"><span class="external-link">Android</span></div><!--]--></a></nav><!--[--><!--]--></main><!--]--></div><!--[--><!----><!--]--><!--]--></div>
    <script type="module" src="/assets/app-Cilg8IT4.js" defer></script>
  </body>
</html>
